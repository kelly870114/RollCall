{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\src\\\\components\\\\Rollcall\\\\Rollcall.js\";\nimport React from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport AppBar from '../AppBar/Appbar';\nimport { FormControlLabel, Radio, RadioGroup, FormControl, InputLabel, MenuItem, Select, OutlinedInput, Typography, TextField } from '@material-ui/core';\nimport { Button } from '@material-ui/core';\nimport Add from '@material-ui/icons/AddBoxOutlined';\nimport NoFace from './noFace.jpg';\nimport axios from 'axios';\nimport Airtable from 'airtable';\nimport { fetchPostAttend } from '../../api';\nvar TABLE_NAME = 'Student';\nvar CLASS_TABLE_NAME = 'ClassDay';\nvar base = new Airtable({\n  apiKey: 'keyA7EKdngjou4Dgy'\n}).base('appcXtOTPnE4QWIIt');\nvar table = base(TABLE_NAME);\nvar classTable = base(CLASS_TABLE_NAME);\nvar IP = \"http://localhost:8080\";\n\nfunction createData(classid, grade) {\n  return {\n    id: classid,\n    grade: grade\n  };\n}\n\nfunction createStuData(stu_id, name, image) {\n  return {\n    id: stu_id,\n    name: name,\n    image: image\n  };\n}\n\nvar styles = function styles(theme) {\n  return {\n    selectBar: {\n      width: '80%',\n      margin: 'auto',\n      marginTop: theme.spacing.unit * 5,\n      border: '#FFBF5F solid 0.8px',\n      borderRadius: '10px',\n      display: 'flex',\n      flexDirection: 'row',\n      minWidth: '900px'\n    },\n    radio: {\n      marginLeft: '20%'\n    },\n    formControl: {\n      margin: 'auto 0',\n      marginLeft: '13%'\n    },\n    label: {\n      fontSize: '14pt'\n    },\n    select: {\n      width: '180px'\n    },\n    buttonStart: {\n      fontSize: '16pt',\n      height: '50px',\n      border: '#FFBF5F solid 0.8px',\n      borderRadius: '10px',\n      margin: 'auto 0',\n      marginLeft: '15%'\n    },\n    info: {\n      width: '80%',\n      minWidth: '900px',\n      margin: 'auto'\n    },\n    photo: {\n      width: '200px',\n      height: '200px',\n      marginLeft: '40%',\n      marginTop: theme.spacing.unit * 10\n    },\n    studentInfo: {\n      fontSize: '16pt',\n      marginLeft: '35%',\n      marginTop: theme.spacing.unit * 5\n    },\n    textField: {\n      float: 'right'\n    },\n    addIcon: {\n      float: 'right',\n      color: '#FFBF5F',\n      fontSize: '40pt',\n      marginTop: theme.spacing.unit * 2\n    },\n    buttonEnd: {\n      float: 'right',\n      fontSize: '16pt',\n      height: '50px',\n      border: '#FFBF5F solid 0.8px',\n      borderRadius: '10px',\n      margin: 'auto 0',\n      marginLeft: theme.spacing.unit\n    },\n    yes: {\n      marginLeft: '36.5%',\n      marginTop: theme.spacing.unit * 2,\n      height: '50px',\n      width: '140px',\n      backgroundColor: 'green'\n    },\n    no: {\n      marginLeft: theme.spacing.unit * 3,\n      marginTop: theme.spacing.unit * 2,\n      height: '50px',\n      width: '140px',\n      backgroundColor: 'red'\n    }\n  };\n};\n\nvar Rollcall =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Rollcall, _React$Component);\n\n  function Rollcall() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Rollcall);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Rollcall)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      value: '',\n      nowClass: '',\n      nowClassKey: '',\n      start: false,\n      end: true,\n      stu_id: '',\n      stu_name: '',\n      stu_img: NoFace,\n      face_id: '',\n      face_time: '',\n      classDataInit: [],\n      classData: [],\n      stuDataInit: [],\n      class_id: ''\n    };\n\n    _this.handleChange = function (name) {\n      return function (event) {\n        _this.setState(_defineProperty({}, name, event.target.value));\n\n        var temp = [];\n\n        if (event.target.value === \"國中\") {\n          for (var index = 0; index < _this.state.classDataInit.length; index++) {\n            if (_this.state.classDataInit[index].grade == \"middle\") {\n              temp.push(_this.state.classDataInit[index]);\n            }\n          }\n\n          _this.setState({\n            classData: temp\n          });\n        } else if (event.target.value === \"高中\") {\n          for (var index = 0; index < _this.state.classDataInit.length; index++) {\n            if (_this.state.classDataInit[index].grade == \"high\") {\n              temp.push(_this.state.classDataInit[index]);\n            }\n          }\n\n          _this.setState({\n            classData: temp\n          });\n        }\n      };\n    };\n\n    _this.handleClassChange = function (name) {\n      return function (event) {\n        _this.setState(_defineProperty({}, name, event.target.value));\n\n        _this.setState({\n          class_id: event.target.value\n        });\n\n        var fileterSentence = 'AND(class_id_link=\"' + event.target.value + '\")';\n        table.select({\n          filterByFormula: fileterSentence,\n          view: \"Grid view\" //maxRecords: 1\n\n        }).eachPage(function (records, fetchNextPage) {\n          _this.setState({\n            records: records\n          });\n\n          var student_name = _this.state.records.map(function (record, index) {\n            return record.fields['student_name'];\n          });\n\n          var student_id = _this.state.records.map(function (record, index) {\n            return record.fields['student_id'];\n          });\n\n          var student_img = _this.state.records.map(function (record, index) {\n            return record.fields['student_img'][0].url;\n          });\n\n          var temp = [];\n\n          for (var index = 0; index < student_name.length; index++) {\n            temp.push(createStuData(student_id[index], student_name[index], student_img[index]));\n          }\n\n          _this.setState({\n            stuDataInit: temp\n          });\n        });\n      };\n    };\n\n    _this.handleStart = function (e) {\n      axios.create({\n        baseURL: IP,\n        headers: {\n          'content-type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      }).get(\"/retrieveface\").then(function (response) {\n        console.log(\"in response\");\n        console.log('open :', response.status, '\\nopen camera', new Date());\n      }).catch(function (error) {\n        return console.error(error);\n      });\n      axios.create({\n        baseURL: IP,\n        headers: {\n          'content-type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      }).get(\"/real\").then(function (response) {}).catch(function (error) {\n        return console.error(error);\n      });\n\n      _this.setState({\n        start: true\n      });\n\n      _this.setState({\n        end: false\n      });\n    };\n\n    _this.handleClickAdd = function (name) {\n      return function (e) {};\n    };\n\n    _this.handleEnd = function (e) {\n      axios.create({\n        baseURL: IP,\n        headers: {\n          'content-type': 'application/json',\n          'Access-Control-Allow-Origin': '*'\n        }\n      }).get(\"/terminate\").then(function (response) {\n        console.log(\"in terminate\");\n      }).catch(function (error) {\n        return console.error(error);\n      });\n\n      _this.setState({\n        start: false\n      });\n\n      _this.setState({\n        end: true\n      });\n    };\n\n    _this.handleYes = function (e) {\n      var data = {\n        fields: {\n          class_id: {},\n          attend_date: {},\n          student_id: {},\n          attend_time: {}\n        }\n      };\n      data.fields.class_id = _this.state.class_id;\n      data.fields.attend_date = _this.state.face_time.split(\" \")[0];\n      data.fields.student_id = _this.state.stu_id;\n      data.fields.attend_time = _this.state.face_time.split(\" \")[1].split(\":\")[0] + \":\" + _this.state.face_time.split(\" \")[1].split(\":\")[1];\n      fetchPostAttend(data);\n    };\n\n    _this.handleNo = function (e) {};\n\n    _this.handleClickAdd = function (name) {\n      return function (e) {};\n    };\n\n    return _this;\n  }\n\n  _createClass(Rollcall, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this;\n\n      if (this.state.face_id !== prevProps.face_id && this.state.end === false) {\n        axios.create({\n          baseURL: IP,\n          headers: {\n            'content-type': 'application/json',\n            'Access-Control-Allow-Origin': '*'\n          }\n        }).get(\"/real\").then(function (response) {\n          var face_id = response.data.split(\"!\")[0];\n          var face_time = response.data.split(\"!\")[1];\n\n          _this2.setState({\n            face_id: face_id\n          });\n\n          _this2.setState({\n            face_time: face_time\n          });\n\n          for (var index = 0; index < _this2.state.stuDataInit.length; index++) {\n            if (_this2.state.stuDataInit[index].id == _this2.state.face_id) {\n              _this2.setState({\n                stu_id: _this2.state.stuDataInit[index].id,\n                stu_name: _this2.state.stuDataInit[index].name,\n                stu_img: _this2.state.stuDataInit[index].image\n              });\n            }\n          }\n        }).catch(function (error) {\n          return console.error(error);\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      classTable.select({\n        //filterByFormula: fileterSentence,\n        view: \"Grid view\" //maxRecords: 1\n\n      }).eachPage(function (records, fetchNextPage) {\n        _this3.setState({\n          records: records\n        });\n\n        var class_id = _this3.state.records.map(function (record, index) {\n          return record.fields['class_id'];\n        });\n\n        var class_grade_id = _this3.state.records.map(function (record, index) {\n          return record.fields['class_grade_id'];\n        });\n\n        var temp = [];\n\n        for (var index = 0; index < class_id.length; index++) {\n          temp.push(createData(class_id[index], class_grade_id[index]));\n        }\n\n        _this3.setState({\n          classDataInit: temp\n        });\n\n        _this3.setState({\n          classData: temp\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var classes = this.props.classes;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, React.createElement(AppBar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: classes.selectBar,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, React.createElement(FormControl, {\n        className: classes.radio,\n        component: \"fieldset\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }, React.createElement(RadioGroup, {\n        \"aria-label\": \"area\",\n        name: \"area\",\n        className: classes.group,\n        value: this.state.value,\n        onChange: this.handleChange('value'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }, React.createElement(FormControlLabel, {\n        classes: {\n          label: classes.label\n        },\n        value: \"\\u570B\\u4E2D\",\n        control: React.createElement(Radio, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 323\n          },\n          __self: this\n        }),\n        label: \"\\u570B\\u4E2D\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }), React.createElement(FormControlLabel, {\n        classes: {\n          label: classes.label\n        },\n        value: \"\\u9AD8\\u4E2D\",\n        control: React.createElement(Radio, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 324\n          },\n          __self: this\n        }),\n        label: \"\\u9AD8\\u4E2D\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324\n        },\n        __self: this\n      }))), React.createElement(FormControl, {\n        variant: \"outlined\",\n        className: classes.formControl,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327\n        },\n        __self: this\n      }, React.createElement(InputLabel, {\n        ref: function ref(_ref) {\n          _this4.InputLabelRef = _ref;\n        },\n        htmlFor: \"outlined-nowClass-simple\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }, \"\\u73ED\\u7D1A\"), React.createElement(Select, {\n        value: this.state.nowClass,\n        onChange: this.handleClassChange('nowClass'),\n        className: classes.select,\n        input: React.createElement(OutlinedInput, {\n          labelWidth: this.state.labelWidth,\n          name: \"nowClass\",\n          id: \"outlined-nowClass-simple\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 341\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, React.createElement(MenuItem, {\n        value: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348\n        },\n        __self: this\n      }, React.createElement(\"em\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 349\n        },\n        __self: this\n      }, \"\\u73ED\\u7D1A\")), this.state.classData.map(function (n, index) {\n        return React.createElement(MenuItem, {\n          key: n.id,\n          value: n.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 353\n          },\n          __self: this\n        }, n.id);\n      }))), React.createElement(Button, {\n        disabled: this.state.start,\n        className: classes.buttonStart,\n        onClick: this.handleStart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362\n        },\n        __self: this\n      }, \"\\u958B\\u59CB\\u9EDE\\u540D\"), React.createElement(Button, {\n        disabled: this.state.end,\n        className: classes.buttonEnd,\n        onClick: this.handleEnd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      }, \"\\u7D50\\u675F\\u9EDE\\u540D\")), this.state.start === true ? React.createElement(\"div\", {\n        className: classes.info,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: classes.photo,\n        src: this.state.stu_img,\n        alt: \"location\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370\n        },\n        __self: this\n      }), React.createElement(\"pre\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 371\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        className: classes.studentInfo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 371\n        },\n        __self: this\n      }, \"\\u59D3\\u540D\\uFF1A\", this.state.stu_name, \"     \\u5B78\\u865F\\uFF1A\", this.state.stu_id, \" \")), React.createElement(Button, {\n        onClick: this.handleYes,\n        className: classes.yes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372\n        },\n        __self: this\n      }, \"Yes\"), React.createElement(Button, {\n        onClick: this.handleNo,\n        className: classes.no,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }, \"NO\"), React.createElement(Add, {\n        className: classes.addIcon,\n        onClick: this.handleClickAdd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"filled-with-placeholder\",\n        label: \"\\u8F38\\u5165\\u5B78\\u865F\",\n        className: classes.textField,\n        margin: \"normal\",\n        variant: \"filled\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Rollcall;\n}(React.Component);\n\nexport default withStyles(styles)(Rollcall);","map":{"version":3,"sources":["C:\\Users\\耍廢社\\Desktop\\MyProject\\src\\components\\Rollcall\\Rollcall.js"],"names":["React","withStyles","AppBar","FormControlLabel","Radio","RadioGroup","FormControl","InputLabel","MenuItem","Select","OutlinedInput","Typography","TextField","Button","Add","NoFace","axios","Airtable","fetchPostAttend","TABLE_NAME","CLASS_TABLE_NAME","base","apiKey","table","classTable","IP","createData","classid","grade","id","createStuData","stu_id","name","image","styles","theme","selectBar","width","margin","marginTop","spacing","unit","border","borderRadius","display","flexDirection","minWidth","radio","marginLeft","formControl","label","fontSize","select","buttonStart","height","info","photo","studentInfo","textField","float","addIcon","color","buttonEnd","yes","backgroundColor","no","Rollcall","state","value","nowClass","nowClassKey","start","end","stu_name","stu_img","face_id","face_time","classDataInit","classData","stuDataInit","class_id","handleChange","event","setState","target","temp","index","length","push","handleClassChange","fileterSentence","filterByFormula","view","eachPage","records","fetchNextPage","student_name","map","record","fields","student_id","student_img","url","handleStart","e","create","baseURL","headers","get","then","response","console","log","status","Date","catch","error","handleClickAdd","handleEnd","handleYes","data","attend_date","attend_time","split","handleNo","prevProps","class_grade_id","classes","props","group","ref","InputLabelRef","labelWidth","n","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport AppBar from '../AppBar/Appbar';\r\nimport {\r\n  FormControlLabel,\r\n  Radio,\r\n  RadioGroup,\r\n  FormControl,\r\n  InputLabel,\r\n  MenuItem,\r\n  Select,\r\n  OutlinedInput,\r\n  Typography,\r\n  TextField\r\n} from '@material-ui/core';\r\nimport { Button } from '@material-ui/core';\r\n\r\nimport Add from '@material-ui/icons/AddBoxOutlined';\r\n\r\nimport NoFace from './noFace.jpg';\r\nimport axios from 'axios';\r\nimport Airtable from 'airtable';\r\nimport { fetchPostAttend } from '../../api';\r\n\r\nconst TABLE_NAME = 'Student';\r\nconst CLASS_TABLE_NAME = 'ClassDay';\r\nconst base = new Airtable({ apiKey: 'keyA7EKdngjou4Dgy' }).base('appcXtOTPnE4QWIIt');\r\nconst table = base(TABLE_NAME);\r\nconst classTable = base(CLASS_TABLE_NAME);\r\n\r\nconst IP = \"http://localhost:8080\";\r\n\r\nfunction createData(classid, grade) {\r\n  return { id: classid, grade};\r\n}\r\n\r\nfunction createStuData(stu_id, name, image) {\r\n  return { id: stu_id, name, image};\r\n}\r\n\r\nconst styles = theme => ({\r\n  selectBar: {\r\n    width: '80%',\r\n    margin: 'auto',\r\n    marginTop: theme.spacing.unit * 5,\r\n    border: '#FFBF5F solid 0.8px',\r\n    borderRadius: '10px',\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    minWidth: '900px',\r\n  },\r\n  radio: {\r\n    marginLeft: '20%',\r\n  },\r\n  formControl: {\r\n    margin: 'auto 0',\r\n    marginLeft: '13%',\r\n  },\r\n  label: {\r\n    fontSize: '14pt',\r\n  },\r\n  select: {\r\n    width: '180px'\r\n  },\r\n  buttonStart: {\r\n    fontSize: '16pt',\r\n    height: '50px',\r\n    border: '#FFBF5F solid 0.8px',\r\n    borderRadius: '10px',\r\n    margin: 'auto 0',\r\n    marginLeft: '15%',\r\n  },\r\n\r\n  info: {\r\n    width: '80%',\r\n    minWidth: '900px',\r\n    margin: 'auto',\r\n  },\r\n\r\n  photo: {\r\n    width: '200px',\r\n    height: '200px',\r\n    marginLeft: '40%',\r\n    marginTop: theme.spacing.unit * 10,\r\n  },\r\n\r\n  studentInfo: {\r\n    fontSize: '16pt',\r\n    marginLeft: '35%',\r\n    marginTop: theme.spacing.unit * 5,\r\n  },\r\n  textField: {\r\n    float:'right',\r\n  },\r\n  addIcon: {\r\n    float:'right',\r\n    color: '#FFBF5F',\r\n    fontSize: '40pt',\r\n    marginTop: theme.spacing.unit * 2,\r\n  },\r\n  buttonEnd: {\r\n    float: 'right',\r\n    fontSize: '16pt',\r\n    height: '50px',\r\n    border: '#FFBF5F solid 0.8px',\r\n    borderRadius: '10px',\r\n    margin: 'auto 0',\r\n    marginLeft: theme.spacing.unit,\r\n  },\r\n  yes: {\r\n    marginLeft: '36.5%',\r\n    marginTop: theme.spacing.unit * 2,\r\n    height:'50px',\r\n    width:'140px',\r\n    backgroundColor: 'green'\r\n  },\r\n  no: {\r\n    marginLeft: theme.spacing.unit * 3,\r\n    marginTop: theme.spacing.unit * 2,\r\n    height:'50px',\r\n    width:'140px',\r\n    backgroundColor: 'red',\r\n  }\r\n});\r\n\r\nclass Rollcall extends React.Component {\r\n  // props = {\r\n  //   face_id:'',\r\n  // }\r\n\r\n  state = {\r\n    value: '',\r\n    nowClass: '',\r\n    nowClassKey: '',\r\n    start: false,\r\n    end: true,\r\n    stu_id: '',\r\n    stu_name: '',\r\n    stu_img: NoFace,\r\n    face_id: '',\r\n    face_time:'',\r\n    classDataInit:[],\r\n    classData:[],\r\n    stuDataInit:[],\r\n    class_id:'',\r\n  };\r\n\r\n  componentDidUpdate(prevProps){\r\n    if (this.state.face_id !== prevProps.face_id && this.state.end===false) {\r\n    axios.create({\r\n      baseURL: IP,\r\n      headers: { 'content-type': 'application/json', 'Access-Control-Allow-Origin': '*' }\r\n    }).get(\"/real\")\r\n      .then((response) => {\r\n        var face_id = response.data.split(\"!\")[0];\r\n        var face_time = response.data.split(\"!\")[1];\r\n\r\n        this.setState({ face_id: face_id });\r\n        this.setState({ face_time: face_time });\r\n\r\n        for (var index = 0; index < this.state.stuDataInit.length; index++) {\r\n          if(this.state.stuDataInit[index].id == this.state.face_id){\r\n            this.setState({ \r\n              stu_id: this.state.stuDataInit[index].id, \r\n              stu_name: this.state.stuDataInit[index].name,\r\n              stu_img: this.state.stuDataInit[index].image });\r\n          }\r\n        }\r\n      })\r\n      .catch((error) =>\r\n        console.error(error)\r\n      );\r\n    }\r\n  }\r\n\r\n  componentDidMount(){\r\n\r\n    classTable.select({\r\n      //filterByFormula: fileterSentence,\r\n      view: \"Grid view\",\r\n      //maxRecords: 1\r\n    }).eachPage((records, fetchNextPage) => {\r\n      this.setState({ records });\r\n\r\n      const class_id = this.state.records.map((record, index) => record.fields['class_id']);\r\n      const class_grade_id = this.state.records.map((record, index) => record.fields['class_grade_id']);\r\n      var temp=[];\r\n      for (var index = 0; index < class_id.length; index++) {\r\n        temp.push(createData(class_id[index], class_grade_id[index]));\r\n      }\r\n      this.setState({ classDataInit: temp });\r\n      this.setState({ classData: temp });\r\n    }\r\n    );\r\n  }\r\n\r\n  handleChange = name => event => {\r\n    this.setState({ [name]: event.target.value });\r\n    var temp=[];\r\n    if (event.target.value === \"國中\") {\r\n      for (var index = 0; index < this.state.classDataInit.length; index++) {\r\n        if(this.state.classDataInit[index].grade == \"middle\"){\r\n          temp.push(this.state.classDataInit[index]);\r\n        }\r\n      }\r\n      this.setState({ classData : temp });\r\n        \r\n    }else if(event.target.value === \"高中\"){\r\n      for (var index = 0; index < this.state.classDataInit.length; index++) {\r\n        if(this.state.classDataInit[index].grade == \"high\"){\r\n          temp.push(this.state.classDataInit[index]);\r\n        }\r\n      }\r\n      this.setState({ classData : temp });\r\n    }\r\n  };\r\n\r\n  handleClassChange = name => event => {\r\n    this.setState({ [name]: event.target.value });\r\n    this.setState({ class_id: event.target.value });\r\n    const fileterSentence = 'AND(class_id_link=\"'+ event.target.value +'\")'\r\n    table.select({\r\n      filterByFormula: fileterSentence,\r\n      view: \"Grid view\",\r\n      //maxRecords: 1\r\n    }).eachPage((records, fetchNextPage) => {\r\n      this.setState({ records });\r\n\r\n      const student_name = this.state.records.map((record, index) => record.fields['student_name']);\r\n      const student_id = this.state.records.map((record, index) => record.fields['student_id']);\r\n      const student_img = this.state.records.map((record, index) => record.fields['student_img'][0].url);\r\n      var temp=[];\r\n      for (var index = 0; index < student_name.length; index++) {\r\n        temp.push(createStuData(student_id[index], student_name[index], student_img[index]));\r\n      }\r\n      this.setState({stuDataInit : temp});\r\n\r\n    }\r\n    );\r\n\r\n  };\r\n\r\n  handleStart = e => {\r\n    axios.create({\r\n      baseURL: IP,\r\n      headers: { 'content-type': 'application/json', 'Access-Control-Allow-Origin': '*' }\r\n    }).get(\"/retrieveface\")\r\n      .then((response) => {\r\n        console.log(\"in response\");\r\n        console.log('open :', response.status, '\\nopen camera', new Date());\r\n      })\r\n      .catch((error) =>\r\n        console.error(error)\r\n      );\r\n\r\n    axios.create({\r\n      baseURL: IP,\r\n      headers: { 'content-type': 'application/json', 'Access-Control-Allow-Origin': '*' }\r\n    }).get(\"/real\")\r\n      .then((response) => {\r\n      })\r\n      .catch((error) =>\r\n        console.error(error)\r\n      );\r\n\r\n    this.setState({ start: true })\r\n    this.setState({ end: false })\r\n  };\r\n\r\n\r\n\r\n\r\n  handleClickAdd = name => e => {\r\n  }\r\n\r\n  handleEnd = e => {\r\n    axios.create({\r\n      baseURL: IP,\r\n      headers: { 'content-type': 'application/json', 'Access-Control-Allow-Origin': '*' }\r\n    }).get(\"/terminate\")\r\n    .then((response) => {\r\n      console.log(\"in terminate\");\r\n  })\r\n  .catch((error) =>\r\n      console.error(error)\r\n  );\r\n\r\n    this.setState({ start: false })\r\n    this.setState({ end: true })\r\n  };\r\n\r\n\r\n  handleYes = e => {\r\n    let data = { fields: { class_id: {}, attend_date: {}, student_id: {}, attend_time: {}  } };\r\n    data.fields.class_id = this.state.class_id;\r\n    data.fields.attend_date = this.state.face_time.split(\" \")[0];\r\n    data.fields.student_id = this.state.stu_id;\r\n    data.fields.attend_time = (this.state.face_time.split(\" \")[1]).split(\":\")[0]+ \":\" +\r\n      (this.state.face_time.split(\" \")[1]).split(\":\")[1];\r\n    fetchPostAttend(data);\r\n  };\r\n\r\n  handleNo = e => {\r\n  };\r\n\r\n  handleClickAdd = name => e => {\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n    return (\r\n      <div>\r\n        <AppBar />\r\n        <div className={classes.selectBar}>\r\n          <FormControl className={classes.radio} component=\"fieldset\">\r\n            <RadioGroup\r\n              aria-label=\"area\"\r\n              name=\"area\"\r\n              className={classes.group}\r\n              value={this.state.value}\r\n              onChange={this.handleChange('value')}\r\n            >\r\n              <FormControlLabel classes={{ label: classes.label, }} value=\"國中\" control={<Radio />} label=\"國中\" />\r\n              <FormControlLabel classes={{ label: classes.label, }} value=\"高中\" control={<Radio />} label=\"高中\" />\r\n            </RadioGroup>\r\n          </FormControl>\r\n          <FormControl variant=\"outlined\" className={classes.formControl}>\r\n            <InputLabel\r\n              ref={ref => {\r\n                this.InputLabelRef = ref;\r\n              }}\r\n              htmlFor=\"outlined-nowClass-simple\"\r\n            >\r\n              班級\r\n                    </InputLabel>\r\n            <Select\r\n              value={this.state.nowClass}\r\n              onChange={this.handleClassChange('nowClass')}\r\n              className={classes.select}\r\n              input={\r\n                <OutlinedInput\r\n                  labelWidth={this.state.labelWidth}\r\n                  name=\"nowClass\"\r\n                  id=\"outlined-nowClass-simple\"\r\n                />\r\n              }\r\n            >\r\n              <MenuItem value=\"\">\r\n                <em>班級</em>\r\n              </MenuItem>\r\n              {(this.state.classData).map((n, index) => {\r\n                return (\r\n                  <MenuItem key={n.id} value={n.id}>{n.id}</MenuItem>\r\n                );\r\n              })}\r\n              {/* <MenuItem value={10}>英文Ａ班</MenuItem>\r\n              <MenuItem value={20}>數學Ａ班</MenuItem>\r\n              <MenuItem value={30}>國文Ｂ班</MenuItem> */}\r\n            </Select>\r\n          </FormControl>\r\n\r\n          <Button disabled={this.state.start} className={classes.buttonStart} onClick={this.handleStart}>開始點名</Button>\r\n          <Button disabled={this.state.end} className={classes.buttonEnd} onClick={this.handleEnd}>結束點名</Button>\r\n        </div>\r\n\r\n\r\n        {\r\n          this.state.start === true ?\r\n            <div className={classes.info}>\r\n              <img className={classes.photo} src={this.state.stu_img} alt=\"location\" />\r\n              <pre><Typography className={classes.studentInfo}>姓名：{this.state.stu_name}     學號：{this.state.stu_id} </Typography></pre>\r\n              <Button onClick={this.handleYes} className={classes.yes} >Yes</Button>\r\n              <Button onClick={this.handleNo} className={classes.no}>NO</Button>\r\n              <Add className={classes.addIcon} onClick={this.handleClickAdd} />\r\n              <TextField\r\n                id=\"filled-with-placeholder\"\r\n                label=\"輸入學號\"\r\n                className={classes.textField}\r\n                margin=\"normal\"\r\n                variant=\"filled\"\r\n              />\r\n            </div> :\r\n            <div></div>\r\n        }\r\n\r\n\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport default withStyles(styles)(Rollcall);"]},"metadata":{},"sourceType":"module"}