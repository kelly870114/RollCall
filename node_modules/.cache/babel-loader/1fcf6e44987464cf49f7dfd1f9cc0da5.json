{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\\\u800D\\u5EE2\\u793E\\\\Desktop\\\\MyProject\\\\src\\\\components\\\\Classpage\\\\Studentpage.js\";\nimport React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Upload from '@material-ui/icons/CreateNewFolderRounded';\nimport { withStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport { NavLink } from \"react-router-dom\"; // import { fromJS, List, Map } from 'immutable'\n\nimport XLSX from 'xlsx';\nimport ArrowIcon from '@material-ui/icons/ArrowForwardRounded';\nimport Airtable from 'airtable';\nvar base = new Airtable({\n  apiKey: 'keyA7EKdngjou4Dgy'\n}).base('appcXtOTPnE4QWIIt');\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      margin: '0 auto',\n      marginTop: theme.spacing.unit,\n      backgroundColor: '#212832',\n      border: 'white 1px solid',\n      overflowX: 'auto'\n    },\n    head: {\n      fontSize: '14pt',\n      color: '#FFBF5F'\n    },\n    content: {\n      fontSize: '12pt'\n    },\n    button: {\n      backgroundColor: '#111B24',\n      color: 'white'\n    },\n    UploadIcon: {\n      margin: '0 auto'\n    },\n    input: {\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      top: 0,\n      left: 0,\n      outline: 'none',\n      opacity: 0\n    }\n  };\n}; // let id = 0;\n// function createData(time, title, content) {\n//     id += 1;\n//     return { id, time, title, content };\n// }\n\n\nvar id = 0;\n\nfunction createData(stuId, stuName) {\n  id += 1; //this.props.callbackFromParent();\n\n  var content = React.createElement(NavLink, {\n    style: {\n      textDecoration: 'none'\n    },\n    activeClassName: \"active\",\n    to: {\n      pathname: '/student',\n      aboutProps: {\n        name: stuId\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(Button, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"\\u66F4\\u591A\\u8CC7\\u8A0A\", React.createElement(ArrowIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }))); //const content = <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>\n\n  return {\n    id: id,\n    stuId: stuId,\n    stuName: stuName,\n    content: content\n  };\n} // const data = [\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\n//     // createData('405401360', '林ＸＸ'),\n//     // createData('405401360', '林ＸＸ'),\n// ]\n\n\nvar Studentpage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Studentpage, _Component);\n\n  function Studentpage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Studentpage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Studentpage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      data: []\n    };\n\n    _this.onImportExcel = function (file) {\n      var files = file.target.files;\n      var fileReader = new FileReader();\n\n      fileReader.onload = function (event) {\n        try {\n          var result = event.target.result;\n          var workbook = XLSX.read(result, {\n            type: 'binary'\n          });\n          var data = [];\n\n          for (var sheet in workbook.Sheets) {\n            if (workbook.Sheets.hasOwnProperty(sheet)) {\n              data = data.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet])); // break;\n            }\n          } // message.success('上傳成功！')\n\n\n          console.log(data);\n        } catch (e) {// message.error('文件類型不正确！');\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n\n    return _this;\n  }\n\n  _createClass(Studentpage, [{\n    key: \"componentDidMount\",\n    //airtable\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      base('Student').select({\n        view: 'Grid view'\n      }).eachPage(function (records, fetchNextPage) {\n        _this2.setState({\n          records: records\n        });\n\n        console.log(records);\n\n        var student_id = _this2.state.records.map(function (record, index) {\n          return record.fields['student_id'];\n        });\n\n        var student_name = _this2.state.records.map(function (record, index) {\n          return record.fields['student_name'];\n        });\n\n        var temp = [];\n\n        for (var index = 0; index < student_id.length; index++) {\n          temp.push(createData(student_id[index], student_name[index]));\n        }\n\n        _this2.setState({\n          data: temp\n        });\n\n        fetchNextPage();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      return React.createElement(\"div\", {\n        style: {\n          borderColor: '#FFBF5F'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Button, {\n        className: classes.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(Upload, {\n        type: \"upload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: classes.input,\n        type: \"file\",\n        accept: \".xlsx, .xls\",\n        onChange: this.onImportExcel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"\\u532F\\u5165\\u5B78\\u751F\\u8CC7\\u6599\"))), this.state.data.length ? React.createElement(Paper, {\n        className: classes.root,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(Table, {\n        className: classes.table,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(TableHead, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        className: classes.head,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"\\u5B78\\u865F\"), React.createElement(TableCell, {\n        className: classes.head,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \"\\u59D3\\u540D\"), React.createElement(TableCell, {\n        className: classes.head,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"\\u500B\\u4EBA\\u9801\\u9762\"))), React.createElement(TableBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, this.state.data.map(function (row) {\n        return React.createElement(TableRow, {\n          key: row.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, React.createElement(TableCell, {\n          className: classes.content,\n          style: {\n            width: '15%'\n          },\n          component: \"th\",\n          scope: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }, row.stuId), React.createElement(TableCell, {\n          className: classes.content,\n          style: {\n            width: '20%'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, row.stuName), React.createElement(TableCell, {\n          className: classes.content,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, row.content));\n      })))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Studentpage;\n}(Component);\n\nexport default withStyles(styles)(Studentpage);","map":{"version":3,"sources":["C:\\Users\\耍廢社\\Desktop\\MyProject\\src\\components\\Classpage\\Studentpage.js"],"names":["React","Component","Button","Upload","withStyles","Table","TableBody","TableCell","TableHead","TableRow","Paper","NavLink","XLSX","ArrowIcon","Airtable","base","apiKey","styles","theme","root","margin","marginTop","spacing","unit","backgroundColor","border","overflowX","head","fontSize","color","content","button","UploadIcon","input","position","width","height","top","left","outline","opacity","id","createData","stuId","stuName","textDecoration","pathname","aboutProps","name","Studentpage","state","data","onImportExcel","file","files","target","fileReader","FileReader","onload","event","result","workbook","read","type","sheet","Sheets","hasOwnProperty","concat","utils","sheet_to_json","console","log","e","readAsBinaryString","select","view","eachPage","records","fetchNextPage","setState","student_id","map","record","index","fields","student_name","temp","length","push","classes","props","borderColor","table","row"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,MAAP,MAAmB,2CAAnB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,SAASC,OAAT,QAAwB,kBAAxB,C,CACA;;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,SAAP,MAAsB,wCAAtB;AACA,OAAOC,QAAP,MAAqB,UAArB;AAEA,IAAMC,IAAI,GAAG,IAAID,QAAJ,CAAa;AAAEE,EAAAA,MAAM,EAAE;AAAV,CAAb,EAA8CD,IAA9C,CAAmD,mBAAnD,CAAb;;AAEA,IAAME,MAAM,GAAG,SAATA,MAAS,CAAAC,KAAK;AAAA,SAAK;AACrBC,IAAAA,IAAI,EAAE;AACFC,MAAAA,MAAM,EAAE,QADN;AAEFC,MAAAA,SAAS,EAAEH,KAAK,CAACI,OAAN,CAAcC,IAFvB;AAGFC,MAAAA,eAAe,EAAE,SAHf;AAIFC,MAAAA,MAAM,EAAE,iBAJN;AAKFC,MAAAA,SAAS,EAAE;AALT,KADe;AAQrBC,IAAAA,IAAI,EAAE;AACFC,MAAAA,QAAQ,EAAE,MADR;AAEFC,MAAAA,KAAK,EAAE;AAFL,KARe;AAYrBC,IAAAA,OAAO,EAAE;AACLF,MAAAA,QAAQ,EAAE;AADL,KAZY;AAerBG,IAAAA,MAAM,EAAE;AACJP,MAAAA,eAAe,EAAE,SADb;AAEJK,MAAAA,KAAK,EAAE;AAFH,KAfa;AAmBrBG,IAAAA,UAAU,EAAE;AACRZ,MAAAA,MAAM,EAAE;AADA,KAnBS;AAsBrBa,IAAAA,KAAK,EAAE;AACHC,MAAAA,QAAQ,EAAE,UADP;AAEHC,MAAAA,KAAK,EAAE,MAFJ;AAGHC,MAAAA,MAAM,EAAE,MAHL;AAIHC,MAAAA,GAAG,EAAE,CAJF;AAKHC,MAAAA,IAAI,EAAE,CALH;AAMHC,MAAAA,OAAO,EAAE,MANN;AAOHC,MAAAA,OAAO,EAAE;AAPN;AAtBc,GAAL;AAAA,CAApB,C,CAiCA;AACA;AACA;AACA;AACA;;;AAEA,IAAIC,EAAE,GAAG,CAAT;;AACA,SAASC,UAAT,CAAoBC,KAApB,EAA2BC,OAA3B,EAAoC;AAChCH,EAAAA,EAAE,IAAI,CAAN,CADgC,CAEhC;;AACA,MAAMX,OAAO,GAAG,oBAAC,OAAD;AAAS,IAAA,KAAK,EAAE;AAAEe,MAAAA,cAAc,EAAE;AAAlB,KAAhB;AAA4C,IAAA,eAAe,EAAC,QAA5D;AAAqE,IAAA,EAAE,EAAE;AAACC,MAAAA,QAAQ,EAAC,UAAV;AAAsBC,MAAAA,UAAU,EAAC;AAACC,QAAAA,IAAI,EAACL;AAAN;AAAjC,KAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyH,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAY,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAZ,CAAzH,CAAhB,CAHgC,CAIhC;;AACA,SAAO;AAAEF,IAAAA,EAAE,EAAFA,EAAF;AAAME,IAAAA,KAAK,EAALA,KAAN;AAAaC,IAAAA,OAAO,EAAPA,OAAb;AAAsBd,IAAAA,OAAO,EAAPA;AAAtB,GAAP;AACH,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;;;IAEMmB,W;;;;;;;;;;;;;;;;;UACFC,K,GAAQ;AACJC,MAAAA,IAAI,EAAC;AADD,K;;UAGRC,a,GAAgB,UAAAC,IAAI,EAAI;AAAA,UACZC,KADY,GACFD,IAAI,CAACE,MADH,CACZD,KADY;AAEpB,UAAME,UAAU,GAAG,IAAIC,UAAJ,EAAnB;;AACAD,MAAAA,UAAU,CAACE,MAAX,GAAoB,UAAAC,KAAK,EAAI;AACzB,YAAI;AAAA,cACQC,MADR,GACmBD,KAAK,CAACJ,MADzB,CACQK,MADR;AAEA,cAAMC,QAAQ,GAAGjD,IAAI,CAACkD,IAAL,CAAUF,MAAV,EAAkB;AAAEG,YAAAA,IAAI,EAAE;AAAR,WAAlB,CAAjB;AACA,cAAIZ,IAAI,GAAG,EAAX;;AACA,eAAK,IAAMa,KAAX,IAAoBH,QAAQ,CAACI,MAA7B,EAAqC;AACjC,gBAAIJ,QAAQ,CAACI,MAAT,CAAgBC,cAAhB,CAA+BF,KAA/B,CAAJ,EAA2C;AACvCb,cAAAA,IAAI,GAAGA,IAAI,CAACgB,MAAL,CAAYvD,IAAI,CAACwD,KAAL,CAAWC,aAAX,CAAyBR,QAAQ,CAACI,MAAT,CAAgBD,KAAhB,CAAzB,CAAZ,CAAP,CADuC,CAEvC;AACH;AACJ,WATD,CAUA;;;AACAM,UAAAA,OAAO,CAACC,GAAR,CAAYpB,IAAZ;AACH,SAZD,CAYE,OAAOqB,CAAP,EAAU,CACR;AACH;AACJ,OAhBD;;AAiBAhB,MAAAA,UAAU,CAACiB,kBAAX,CAA8BnB,KAAK,CAAC,CAAD,CAAnC;AACH,K;;;;;;;AAED;wCACoB;AAAA;;AAChBvC,MAAAA,IAAI,CAAC,SAAD,CAAJ,CAAgB2D,MAAhB,CAAuB;AAACC,QAAAA,IAAI,EAAE;AAAP,OAAvB,EACCC,QADD,CAEI,UAACC,OAAD,EAAUC,aAAV,EAA4B;AAC5B,QAAA,MAAI,CAACC,QAAL,CAAc;AAACF,UAAAA,OAAO,EAAPA;AAAD,SAAd;;AACAP,QAAAA,OAAO,CAACC,GAAR,CAAYM,OAAZ;;AACA,YAAMG,UAAU,GAAG,MAAI,CAAC9B,KAAL,CAAW2B,OAAX,CAAmBI,GAAnB,CAAuB,UAACC,MAAD,EAASC,KAAT;AAAA,iBAAmBD,MAAM,CAACE,MAAP,CAAc,YAAd,CAAnB;AAAA,SAAvB,CAAnB;;AACA,YAAMC,YAAY,GAAG,MAAI,CAACnC,KAAL,CAAW2B,OAAX,CAAmBI,GAAnB,CAAuB,UAACC,MAAD,EAASC,KAAT;AAAA,iBAAmBD,MAAM,CAACE,MAAP,CAAc,cAAd,CAAnB;AAAA,SAAvB,CAArB;;AAEA,YAAIE,IAAI,GAAG,EAAX;;AACA,aAAI,IAAIH,KAAK,GAAG,CAAhB,EAAmBA,KAAK,GAAGH,UAAU,CAACO,MAAtC,EAA8CJ,KAAK,EAAnD,EAAuD;AACnDG,UAAAA,IAAI,CAACE,IAAL,CAAU9C,UAAU,CAACsC,UAAU,CAACG,KAAD,CAAX,EAAmBE,YAAY,CAACF,KAAD,CAA/B,CAApB;AACH;;AAED,QAAA,MAAI,CAACJ,QAAL,CAAc;AAAE5B,UAAAA,IAAI,EAAGmC;AAAT,SAAd;;AAEAR,QAAAA,aAAa;AACZ,OAhBL;AAmBH;;;6BACQ;AAAA,UACGW,OADH,GACe,KAAKC,KADpB,CACGD,OADH;AAEL,aACI;AAAK,QAAA,KAAK,EAAE;AAAEE,UAAAA,WAAW,EAAE;AAAf,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,MAAD;AAAQ,QAAA,SAAS,EAAEF,OAAO,CAAC1D,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,MAAD;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI;AAAO,QAAA,SAAS,EAAE0D,OAAO,CAACxD,KAA1B;AAAiC,QAAA,IAAI,EAAC,MAAtC;AAA6C,QAAA,MAAM,EAAC,aAApD;AAAkE,QAAA,QAAQ,EAAE,KAAKmB,aAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,EAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gDAHJ,CADJ,CADJ,EASQ,KAAKF,KAAL,CAAWC,IAAX,CAAgBoC,MAAhB,GAEI,oBAAC,KAAD;AAAO,QAAA,SAAS,EAAEE,OAAO,CAACtE,IAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,SAAS,EAAEsE,OAAO,CAACG,KAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,SAAD;AAAW,QAAA,SAAS,EAAEH,OAAO,CAAC9D,IAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,EAEI,oBAAC,SAAD;AAAW,QAAA,SAAS,EAAE8D,OAAO,CAAC9D,IAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,EAGI,oBAAC,SAAD;AAAW,QAAA,SAAS,EAAE8D,OAAO,CAAC9D,IAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAHJ,CADJ,CADJ,EAQI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKuB,KAAL,CAAWC,IAAX,CAAgB8B,GAAhB,CAAoB,UAAAY,GAAG;AAAA,eACpB,oBAAC,QAAD;AAAU,UAAA,GAAG,EAAEA,GAAG,CAACpD,EAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI,oBAAC,SAAD;AAAW,UAAA,SAAS,EAAEgD,OAAO,CAAC3D,OAA9B;AAAuC,UAAA,KAAK,EAAE;AAAEK,YAAAA,KAAK,EAAE;AAAT,WAA9C;AAAgE,UAAA,SAAS,EAAC,IAA1E;AAA+E,UAAA,KAAK,EAAC,KAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA4F0D,GAAG,CAAClD,KAAhG,CADJ,EAEI,oBAAC,SAAD;AAAW,UAAA,SAAS,EAAE8C,OAAO,CAAC3D,OAA9B;AAAuC,UAAA,KAAK,EAAE;AAAEK,YAAAA,KAAK,EAAE;AAAT,WAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAiE0D,GAAG,CAACjD,OAArE,CAFJ,EAGI,oBAAC,SAAD;AAAW,UAAA,SAAS,EAAE6C,OAAO,CAAC3D,OAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAwC+D,GAAG,CAAC/D,OAA5C,CAHJ,CADoB;AAAA,OAAvB,CADL,CARJ,CADJ,CAFJ,GAuBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAhCZ,CADJ;AAqCH;;;;EAxFqB7B,S;;AA2F1B,eAAeG,UAAU,CAACa,MAAD,CAAV,CAAmBgC,WAAnB,CAAf","sourcesContent":["import React, { Component } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Upload from '@material-ui/icons/CreateNewFolderRounded';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { NavLink } from \"react-router-dom\";\r\n// import { fromJS, List, Map } from 'immutable'\r\nimport XLSX from 'xlsx';\r\nimport ArrowIcon from '@material-ui/icons/ArrowForwardRounded';\r\nimport Airtable from 'airtable';\r\n\r\nconst base = new Airtable({ apiKey: 'keyA7EKdngjou4Dgy' }).base('appcXtOTPnE4QWIIt');\r\n\r\nconst styles = theme => ({\r\n    root: {\r\n        margin: '0 auto',\r\n        marginTop: theme.spacing.unit,\r\n        backgroundColor: '#212832',\r\n        border: 'white 1px solid',\r\n        overflowX: 'auto',\r\n    },\r\n    head: {\r\n        fontSize: '14pt',\r\n        color: '#FFBF5F',\r\n    },\r\n    content: {\r\n        fontSize: '12pt',\r\n    },\r\n    button: {\r\n        backgroundColor: '#111B24',\r\n        color: 'white',\r\n    },\r\n    UploadIcon: {\r\n        margin: '0 auto',\r\n    },\r\n    input: {\r\n        position: 'absolute',\r\n        width: '100%',\r\n        height: '100%',\r\n        top: 0,\r\n        left: 0,\r\n        outline: 'none',\r\n        opacity: 0,\r\n    },\r\n});\r\n\r\n// let id = 0;\r\n// function createData(time, title, content) {\r\n//     id += 1;\r\n//     return { id, time, title, content };\r\n// }\r\n\r\nlet id = 0;\r\nfunction createData(stuId, stuName) {\r\n    id += 1;\r\n    //this.props.callbackFromParent();\r\n    const content = <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to={{pathname:'/student', aboutProps:{name:stuId}}}><Button>更多資訊<ArrowIcon/></Button></NavLink>\r\n    //const content = <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>\r\n    return { id, stuId, stuName, content };\r\n}\r\n\r\n// const data = [\r\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\r\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\r\n//     // createData('405401360', '林ＸＸ', <NavLink style={{ textDecoration: 'none' }} activeClassName=\"active\" to=\"/student\"><Button>更多資訊<ArrowIcon/></Button></NavLink>),\r\n//     // createData('405401360', '林ＸＸ'),\r\n//     // createData('405401360', '林ＸＸ'),\r\n// ]\r\n\r\nclass Studentpage extends Component {\r\n    state = {\r\n        data:[],\r\n    }\r\n    onImportExcel = file => {\r\n        const { files } = file.target;\r\n        const fileReader = new FileReader();\r\n        fileReader.onload = event => {\r\n            try {\r\n                const { result } = event.target;\r\n                const workbook = XLSX.read(result, { type: 'binary' });\r\n                let data = [];\r\n                for (const sheet in workbook.Sheets) {\r\n                    if (workbook.Sheets.hasOwnProperty(sheet)) {\r\n                        data = data.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));\r\n                        // break;\r\n                    }\r\n                }\r\n                // message.success('上傳成功！')\r\n                console.log(data);\r\n            } catch (e) {\r\n                // message.error('文件類型不正确！');\r\n            }\r\n        };\r\n        fileReader.readAsBinaryString(files[0]);\r\n    }\r\n\r\n    //airtable\r\n    componentDidMount() {\r\n        base('Student').select({view: 'Grid view'})\r\n        .eachPage(\r\n            (records, fetchNextPage) => {\r\n            this.setState({records});\r\n            console.log(records);\r\n            const student_id = this.state.records.map((record, index) => record.fields['student_id']);\r\n            const student_name = this.state.records.map((record, index) => record.fields['student_name']);\r\n\r\n            var temp = [];\r\n            for(var index = 0; index < student_id.length; index++) {\r\n                temp.push(createData(student_id[index],student_name[index]));  \r\n            }\r\n\r\n            this.setState({ data : temp });\r\n\r\n            fetchNextPage();\r\n            }\r\n        );\r\n\r\n    }\r\n    render() {\r\n        const { classes } = this.props;\r\n        return (\r\n            <div style={{ borderColor: '#FFBF5F' }}>\r\n                <div>\r\n                    <Button className={classes.button}>\r\n                        <Upload type='upload' />\r\n                        <input className={classes.input} type='file' accept='.xlsx, .xls' onChange={this.onImportExcel} />\r\n                        <span>匯入學生資料</span>\r\n                    </Button>\r\n                </div>\r\n                {\r\n                    this.state.data.length\r\n                        ?\r\n                        <Paper className={classes.root}>\r\n                            <Table className={classes.table}>\r\n                                <TableHead >\r\n                                    <TableRow>\r\n                                        <TableCell className={classes.head}>學號</TableCell>\r\n                                        <TableCell className={classes.head}>姓名</TableCell>\r\n                                        <TableCell className={classes.head}>個人頁面</TableCell>\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {this.state.data.map(row => (\r\n                                        <TableRow key={row.id}>\r\n                                            <TableCell className={classes.content} style={{ width: '15%' }} component=\"th\" scope=\"row\">{row.stuId}</TableCell>\r\n                                            <TableCell className={classes.content} style={{ width: '20%' }}>{row.stuName}</TableCell>\r\n                                            <TableCell className={classes.content}>{row.content}</TableCell>\r\n                                        </TableRow>\r\n                                    ))}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </Paper>\r\n                        :\r\n                        <div></div>\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(Studentpage);\r\n"]},"metadata":{},"sourceType":"module"}